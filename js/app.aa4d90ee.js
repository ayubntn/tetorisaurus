(function(t){function s(s){for(var e,a,l=s[0],n=s[1],r=s[2],d=0,f=[];d<l.length;d++)a=l[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);h&&h(s);while(f.length)f.shift()();return c.push.apply(c,r||[]),i()}function i(){for(var t,s=0;s<c.length;s++){for(var i=c[s],e=!0,l=1;l<i.length;l++){var n=i[l];0!==o[n]&&(e=!1)}e&&(c.splice(s--,1),t=a(a.s=i[0]))}return t}var e={},o={app:0},c=[];function a(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=e,a.d=function(t,s,i){a.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,s){if(1&s&&(t=a(t)),8&s)return t;if(4&s&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var e in t)a.d(i,e,function(s){return t[s]}.bind(null,e));return i},a.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(s,"a",s),s},a.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},a.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],n=l.push.bind(l);l.push=s,l=l.slice();for(var r=0;r<l.length;r++)s(l[r]);var h=n;c.push([0,"chunk-vendors"]),i()})({0:function(t,s,i){t.exports=i("56d7")},1038:function(t,s,i){t.exports=i.p+"img/stop.4726205a.svg"},"3b45":function(t,s,i){t.exports=i.p+"img/tern.9c99bd18.svg"},5301:function(t,s,i){t.exports=i.p+"img/drop.ad4991bf.svg"},"56d7":function(t,s,i){"use strict";i.r(s);var e=i("2b0e"),o=function(){var t=this,s=t._self._c;return s("div",{class:"level"+(t.score+1),attrs:{id:"app"}},[s("div",{staticClass:"wall wall1"}),s("div",{staticClass:"wall wall2"}),s("div",{staticClass:"wall wall3"}),s("div",{staticClass:"wall wall4"}),s("div",{staticClass:"wall wall5"}),s("div",{staticClass:"gameContainer"},[s("div",{staticClass:"leftSide"},[s("div",{staticClass:"side scoreBoard"},[s("img",{staticClass:"logo",attrs:{src:i("cf05")}}),s("p",{staticClass:"scoreBoard_text"},[t._v("Play Tetris for free. Browser-based online Tetris game.")]),s("hr"),s("div",{staticClass:"scoreBoard_score"},[s("img",{staticClass:"icon",attrs:{src:i("7cd5")}}),s("p",{staticClass:"head"},[t._v("SCORE")]),s("div",{staticClass:"scoreBoard_score_card"},[s("img",{attrs:{src:i("faee")}}),s("span",{staticClass:"num"},[t._v(t._s(t.formattedScore))])])]),s("hr"),s("div",{staticClass:"scoreBoard_level"},[s("p",{staticClass:"head"},[t._v("SPEED LEVEL")]),s("ul",[s("li",{class:t.speedLevel>=1?"active":""}),s("li",{class:t.speedLevel>=2?"active":""}),s("li",{class:t.speedLevel>=3?"active":""}),s("li",{class:t.speedLevel>=4?"active":""}),s("li",{class:t.speedLevel>=5?"active":""})])])]),s("div",{staticClass:"side stateBoard"},[s("button",{staticClass:"btn",attrs:{type:"button"},on:{click:t.play}},[s("span",{staticClass:"mini"},[t._v("Space")]),t._v("PLAY"),s("img",{attrs:{src:i("5830")}})]),s("button",{staticClass:"btn",attrs:{type:"button"},on:{click:t.stop}},[s("span",{staticClass:"mini"},[t._v("Shift")]),t._v("STOP"),s("img",{attrs:{src:i("1038")}})])])]),t._m(0),s("div",{staticClass:"side rightSide"},[s("p",{staticClass:"head"},[t._v("NEXT")]),s("div",{attrs:{id:"side"}}),s("div",{staticClass:"control"},[s("img",{staticClass:"icon",attrs:{src:i("583f")}}),s("p",{staticClass:"head"},[t._v("CONTROL")]),s("div",{staticClass:"control_btn"},[s("button",{staticClass:"btn control_btn_up",attrs:{type:"button"},on:{click:t.tern}},[s("img",{attrs:{src:i("3b45")}})]),s("button",{staticClass:"btn control_btn_left",attrs:{type:"button"},on:{click:t.left}},[s("img",{attrs:{src:i("c75b")}})]),s("button",{staticClass:"btn control_btn_right",attrs:{type:"button"},on:{click:t.right}},[s("img",{attrs:{src:i("c917")}})]),s("button",{ref:"dropBtn",staticClass:"btn control_btn_drop",attrs:{type:"button"}},[s("img",{attrs:{src:i("5301")}})])])])])])])},c=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"main"},[s("div",{attrs:{id:"game"}})])}],a=(i("bcb6"),i("ade3"));i("14d9");const l=[{name:"type0",blocks:[{x:0,y:0},{x:1,y:0},{x:1,y:1},{x:1,y:2}],cols:2,rows:3},{name:"type1",blocks:[{x:0,y:0},{x:1,y:0},{x:2,y:0},{x:3,y:0}],cols:4,rows:1},{name:"type2",blocks:[{x:0,y:0},{x:0,y:1},{x:0,y:2},{x:1,y:1}],cols:2,rows:3},{name:"type3",blocks:[{x:0,y:0},{x:0,y:1},{x:1,y:1},{x:1,y:2}],cols:2,rows:3},{name:"type4",blocks:[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}],cols:2,rows:2},{name:"type5",blocks:[{x:0,y:0},{x:0,y:1},{x:1,y:0},{x:0,y:2}],cols:2,rows:3}];class n{constructor(){this.types=[];for(let t=0;t<n.limit;t++)this.types.push(l[n.random()]);this.shiftCount=0}shift(){return this.types.push(l[n.random()]),this.shiftCount++,this.types.shift()}static random(){return Math.floor(Math.random()*l.length)}}Object(a["a"])(n,"limit",3);var r=i("d4ef"),h=i.n(r);class d{constructor(t,s,i){this.row=t,this.col=s,this.blockSize=i,this.width=this.blockSize*this.col,this.height=this.blockSize*this.row,this.blockHalfSize=this.blockSize/2,this.blockScale=this.blockSize/24,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.blockSteps=[this.blockHalfSize];for(let e=1;e<this.row;e++)this.blockSteps.push(this.blockSize*e+this.blockHalfSize);this.grid=[];for(let e=0;e<this.row;e++)this.grid.push(this.blockSize*e)}}i("3c65");function f(t,s){let i=[],e=0;return t.forEach((t,o)=>{i[o]=Math.abs(s-t),e=i[e]<i[o]?e:o}),t[e]}class p{constructor(t,s){this.config=s,this.game=t,this.considering=!1,this._blankRow=[];for(let i=0;i<this.config.col;i++)this._blankRow[i]=null;this.stackedBlocks=[];for(let i=0;i<this.config.row;i++)this.stackedBlocks.push(this._blankRow.concat());this.staticBlocks=t.physics.add.staticGroup()}getStaticBlocks(){return this.staticBlocks}stack(t){this.considering=!0,t.getBlocks().forEach(s=>{if(s.disableBody(!0,!0),s!=t.axis){let t=f(this.config.blockSteps,s.y),i=this.staticBlocks.create(s.x,t,s.texture.key);const e=Math.trunc(i.y/this.config.blockSize),o=Math.trunc(i.body.x/this.config.blockSize);this.stackedBlocks[e][o]=i,this._stackedBlocksLog()}})}deleteCompLine(t){let s=[];for(let[c,a]of this.stackedBlocks.entries()){let t=a.every(t=>null!=t);t&&s.push(c)}const i=[];for(let c of s)for(let t=0;t<this.config.col;t++){let s=this.stackedBlocks[c][t];s.disableBody(!0,!0);let e=this.game.physics.add.sprite(s.x,s.y,s.texture.key);this.game.tweens.add({targets:e,alpha:0,duration:500});let o=this.game.physics.add.sprite(s.x,s.body.y,"axis");o.anims.play("light",!0),i.push(e),i.push(o)}const e=()=>{for(let t of s)for(let s=0;s<=t;s++)for(let t=0;t<this.config.col;t++){let i=this.stackedBlocks[s][t];null!=i&&(i.setY(i.y+this.config.blockSize),i.refreshBody())}this.stackedBlocks=this.stackedBlocks.filter((t,i)=>!s.includes(i)),s.forEach(()=>{this.stackedBlocks.unshift(this._blankRow.concat())});for(let t of i)t.destroy();this.considering=!1,t()};let o=0;return s.length>0&&(o=500),setTimeout(e,o),s.length}_stackedBlocksLog(){for(let[t,s]of this.stackedBlocks.entries()){let i=`[${t}]`;for(let t of s)i+=null!=t?"o ":"x ";console.log(i)}}}class u{constructor(t,s){this.game=t,this.config=s,u.makeBgGraphics(t,s)}static makeBgGraphics(t,s){let i=t.make.graphics();return i.fillStyle(0,.5),i.fillRect(0,0,s.width,200),i.generateTexture("infoBg",s.width,200),i}showEnd(){this.bg=this.game.add.sprite(this.config.halfWidth,this.config.halfHeight,"infoBg"),this.text=this.game.add.text(this.config.halfWidth-55,this.config.halfHeight-20,"おわり",{fontSize:"40px",fill:"#fff"})}showPause(){this.bg=this.game.add.sprite(this.config.halfWidth,this.config.halfHeight,"infoBg"),this.text=this.game.add.text(this.config.halfWidth-120,this.config.halfHeight-20,"いちじていし",{fontSize:"40px",fill:"#fff"})}clear(){this.bg&&this.bg.destroy(),this.text&&this.text.destroy()}}class g{constructor(t,s,i){this.config=s,this.width=i.cols*s.blockSize,this.height=i.rows*s.blockSize;let e=t.physics.add.group();const o=s.blockHalfSize+s.blockSize*(i.cols/2-1);let c=s.halfWidth;i.cols%2===1&&(c+=s.blockHalfSize);let a=i.rows*s.blockSize*-1+i.rows*s.blockSize/2;this.axis=e.create(c,a,"axis"),i.blocks.forEach(t=>{const c=s.blockSize*t.x+s.halfWidth-o,a=-1*(s.blockSize*t.y+s.blockHalfSize);let l=e.create(c,a,i.name);l.setScale(s.blockScale)}),this.physicsGroup=e,this.hasOdd=i.cols%2===1||i.rows%2===1,this.xOdd=i.cols%2===1,this.direction=1}getPhysicsGroup(){return this.physicsGroup}getBlocks(){return this.physicsGroup.getChildren()}rotate(){let t=this.width;this.direction%2===1&&(t=this.height);let s=this.axis.x-t/2,i=this.axis.x+t/2+(this.xOdd?this.config.blockHalfSize:0);s<0&&this.physicsGroup.incX(this.config.blockSize),i>this.config.width&&this.physicsGroup.incX(-1*(i-this.config.width)),this.hasOdd&&(this.xOdd?this.physicsGroup.incX(this.config.blockHalfSize):this.physicsGroup.incX(-1*this.config.blockHalfSize),this.xOdd=!this.xOdd),this.physicsGroup.rotateAround(this.axis,Math.PI/180*90*-1),this.direction=(this.direction+1)%4}adjustX(){this.getBlocks().forEach(t=>{if(t!=this.axis){let s=f(this.config.blockSteps,t.x);t.setX(s)}})}collided(){let t=!1;return this.getBlocks().forEach(s=>{t||s==this.axis||(s.body.touching.down||s.y>=this.config.height-this.config.blockHalfSize)&&(t=!0)}),t}incPoint(t,s){this.physicsGroup.incXY(t,s)}setVelocityY(t){this.physicsGroup.setVelocityY(t)}moveLeft(){const t=this.config.blockHalfSize;t<this.getMinX()&&this.physicsGroup.incX(-1*this.config.blockSize)}moveRight(){const t=this.config.width-this.config.blockHalfSize;t>this.getMaxX()&&this.physicsGroup.incX(this.config.blockSize)}getMinX(){let t=99999;return this.getBlocks().forEach(s=>{t=s.x<t?s.x:t}),t}getMaxX(){let t=0;return this.getBlocks().forEach(s=>{t=s.x>t?s.x:t}),t}getMinY(){let t=99999;return this.getBlocks().forEach(s=>{t=s.y<t?s.y:t}),t}disable(){this.getBlocks().forEach(t=>{t.disableBody(!0,!0)})}}function b(t){t.load.image("type0","img/block0.png"),t.load.image("type1","img/block1.png"),t.load.image("type2","img/block2.png"),t.load.image("type3","img/block3.png"),t.load.image("type4","img/block4.png"),t.load.image("type5","img/block5.png"),t.load.spritesheet("lightImage","img/pipo-btleffect008.png",{frameWidth:120,frameHeight:120}),t.load.image("key_operation","img/key_operation.png")}function y(t,s){let i=t.make.graphics();return i.fillStyle(0,1),i.fillPoint(s.blockSize,s.blockSize,1),i.generateTexture("axis",1,1),i}let k,m,v=30,w=v,x=!1;function S(t,s){let i,e,o,c=!1,a=new d(22,10,24),l={parent:"game",type:h.a.AUTO,width:a.width,height:a.height,physics:{default:"arcade",arcade:{debug:!1}},scene:{preload:n,create:r,update:f},backgroundColor:16777215,transparent:!0};function n(){b(this),y(this,a)}function r(){e=new p(this,a),o=new u(this,a),this.add.grid(a.width/2,a.height/2,a.width,a.height,a.blockSize,a.blockSize,15658734,0,15658734,.2),i=this.input.keyboard.createCursorKeys(),this.anims.create({key:"light",frames:this.anims.generateFrameNumbers("lightImage",{start:0,end:8}),frameRate:10,repeat:1})}function f(){m=this,"ready"==t.status||"pause"==t.status?i.space.isDown&&(t.status="start",this.physics.resume()):"start"==t.status&&i.shift.isDown&&(t.status="pause",this.physics.pause()),"start"!=t.status||e.considering||(k||(k=new g(this,a,s.shift()),this.physics.add.collider(k.getPhysicsGroup(),e.getStaticBlocks())),k.setVelocityY(w+30*t.speedLevel),S(),k.adjustX(),k.collided()&&(k.getMinY()<=0&&(o.showEnd(),t.status="end"),e.stack(k),t.score+=e.deleteCompLine(()=>{k=null,t.speedLevel=Math.floor(t.score/10)+1})))}function S(){x||(i.left.isDown?c||(k.moveLeft(),c=!0):i.right.isDown?c||(k.moveRight(),c=!0):i.up.isDown?c||(c=!0,k.rotate()):i.down.isDown?w=4*v<200?200:4*v:(c=!1,w=v))}new h.a.Game(l)}function A(){k.rotate()}function B(){k.moveLeft()}function C(){k.moveRight()}function z(){x=!0,w=4*v<200?200:4*v}function _(){x=!1,w=v}function E(){m.physics.resume()}function O(){m.physics.pause()}function P(t,s){let i={parent:"side",type:h.a.AUTO,width:98,height:170,physics:{default:"arcade",arcade:{debug:!1}},scene:{preload:a,create:l,update:n},backgroundColor:16777215};new h.a.Game(i);let e=new d(4,4,12),o=0,c=[];function a(){b(this),y(this,e)}function l(){r(this)}function n(){s.shiftCount>o&&(c.forEach(t=>{t.disable()}),c=[],r(this),o=s.shiftCount)}function r(t){let i=20;s.types.forEach(s=>{let o=new g(t,e,s);o.incPoint(24,i+s.rows*e.blockSize),c.push(o),i=i+s.rows*e.blockSize+10})}}let L=new n;var X={name:"App",components:{},data(){return{status:"ready",score:0,speedLevel:1,dropInterval:null}},created(){S(this,L),P(this,L)},mounted(){this.$refs.dropBtn.onmousedown=this.drop,this.$refs.dropBtn.onmouseup=this.dropEnd},computed:{formattedScore(){return("0000"+this.score).slice(-4)}},methods:{play(){this.status="start",E()},stop(){this.status="pause",O()},tern(){"start"==this.status&&A()},left(){"start"==this.status&&B()},right(){"start"==this.status&&C()},drop(){"start"==this.status&&(this.dropInterval=setInterval(()=>{z()},20))},dropEnd(){"start"==this.status&&(clearInterval(this.dropInterval),_())}}},H=X,R=(i("5915"),i("2877")),G=Object(R["a"])(H,o,c,!1,null,null,null),T=G.exports;e["a"].config.productionTip=!1,new e["a"]({render:t=>t(T)}).$mount("#app")},5830:function(t,s,i){t.exports=i.p+"img/play.b8995da7.svg"},"583f":function(t,s,i){t.exports=i.p+"img/control.a7e0c6f9.svg"},5915:function(t,s,i){"use strict";i("9644")},"7cd5":function(t,s,i){t.exports=i.p+"img/crown.0666599b.svg"},9644:function(t,s,i){},c75b:function(t,s,i){t.exports=i.p+"img/left.0bc0b0d9.svg"},c917:function(t,s,i){t.exports=i.p+"img/right.4244c3b6.svg"},cf05:function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALwAAAAwCAYAAACrOxAIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGNSURBVHgB7d2hSi1RFAZg5950yy2+hcVmFMHgA9gMPoJgsinaTIKPYLD5AAZBjDaLb2GxmERRsAjus2QPo5z/+8oJZw+zZ+8/bFismeHl4ORloWE43B3efh/u/zfHLS49vo+7vltpjltbvh1a/69vnDWvv7rc/tZ9nreWmuP+nt8351N97up9quvdO5+do4vmuNP9zUn36yv/bo6b1z+t7n0rf7Pm82cBggg8UQSeKAJPFIEnisATReABgDkwVAdWK3e9eit/P2Wq9emtbH7Wu96910+1bh+c4Yki8EQReKIIPFEEnigCTxSBBwDmQLmK1dsbWjV2L2a1Z7JXb69qVXUfqs/dW+nsrbRW122sXDjDE0XgiSLwRBF4ogg8UQSeKAIPAMyBX9fTOlXFcmxTVXSrlc2xe1+/8tv2a9Zbhp3hiSLwRBF4ogg8UQSeKAJPFIEHAOZAuQo21Vt9qz2bY323c6yK41T3qT53Ve++9vY6j93DPGs+zvBEEXiiCDxRBJ4oAk8UgSeKwBPlFeFmzo0HPui9AAAAAElFTkSuQmCC"},faee:function(t,s,i){t.exports=i.p+"img/score_cards.47c68a2f.png"}});
//# sourceMappingURL=app.aa4d90ee.js.map